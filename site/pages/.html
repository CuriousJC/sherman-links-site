<!DOCTYPE html>
<html>
  <head>
    <title>KNN Classifier</title>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@2.7.0/dist/tf.min.js"></script>
  </head>
  <body>
    <h1>KNN Classifier</h1>
    <form id="input-form">
      <label for="image">Upload an image:</label>
      <input type="file" id="image" accept="image/*">
      <button id="classify-btn">Classify</button>
      <p id="result"></p>
    </form>

    <script src="knn_classifier.js"></script>
// Load the MNIST dataset
const mnist = tf.load('mnist');

// Create a KNN classifier with k=5
const k = 5;
const knn = {
  classify(x) {
    const distances = [];
    for (let i = 0; i < mnist.data.length; i++) {
      const distance = tf.sqrt(tf.dot(x, mnist.data[i]) / (mnist.data[i].length * mnist.data[i].length));
      distances.push({ distance, label: mnist.labels[i] });
    }
    distances.sort((a, b) => a.distance - b.distance);
    const labels = [];
    for (let i = 0; i < k; i++) {
      labels.push(distances[i].label);
    }
    return tf.argMode(labels).dataSync();
  }
};

// Set up the form submission event handler
document.getElementById('classify-btn').addEventListener('click', async () => {
  const imageFile = document.getElementById('image').files[0];
  const img = await tf.fromPixels(imageFile);
  const resizedImg = tf.image.resizeBilinear(img, [28, 28]);
    
  const flattenedImg = resizedImg.flatten();
  const predictedLabel = knn.classify(flattenedImg);
  document.getElementById('result').innerText = `Predicted label: ${predictedLabel}`;
});  
    </body>
</html>
